<!DOCTYPE html>
<html>
<head>
    <title>Expense Tracker</title>
</head>
<body onload="initDB()">
    <h2>Expense Tracker</h2>
    <input type="text" id="title" placeholder="Title">
    <input type="number" id="amount" placeholder="Amount">
    <input type="date" id="date">
    <button onclick="addExpense()">Add Expense</button>
    <button onclick="viewExpenses()">View Expenses</button>

    <ul id="expenseList"></ul>

    <script>
        let db;

        function initDB() {
            
            db = openDatabase('ExpenseDB', '1.0', 'Tracker', 2 * 1024 * 1024);
            db.transaction(function (tx) {
                tx.executeSql('CREATE TABLE IF NOT EXISTS EXPENSES (id INTEGER PRIMARY KEY, title, amount, date)');
            }, transactionError);
        }

        function addExpense() {
            const title = document.getElementById('title').value;
            const amount = document.getElementById('amount').value;
            const date = document.getElementById('date').value;

            db.transaction(function (tx) {
                
                tx.executeSql('INSERT INTO EXPENSES (title, amount, date) VALUES (?, ?, ?)', [title, amount, date]);
            }, transactionError, viewExpenses);
        }

        function viewExpenses() {
            db.transaction(function (tx) {
                tx.executeSql('SELECT * FROM EXPENSES', [], function (tx, results) {
                    const list = document.getElementById('expenseList');
                    list.innerHTML = "";
                    for (let i = 0; i < results.rows.length; i++) {
                        const item = results.rows.item(i);
                        list.innerHTML += `<li>${item.title} - $${item.amount} (${item.date}) 
                            <button onclick="deleteExpense(${item.id})">Delete</button></li>`;
                    }
                }, queryError); 
            });
        }

        function deleteExpense(id) {
            db.transaction(function (tx) {
                tx.executeSql('DELETE FROM EXPENSES WHERE id=?', [id], viewExpenses, queryError);
            });
        }

        function transactionError(err) { alert("Transaction Error: " + err.message); }
        function queryError(tx, err) { alert("Query Error: " + err.message); }
    </script>
</body>
</html>